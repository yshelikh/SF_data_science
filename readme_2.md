## Введение

Заболеваемость и смертность от сердечно-сосудистых заболеваний (ССЗ) продолжает расти во всем мире на протяжении последних нескольких десятилетий. Машинное обучение и нейронные сети дают возможность повысить точность прогнозирования рисков сердечно-сосудистых заболеваний.

В этом учебном проекте приводится анализ статьи о применении моделей машинного обучения для предсказания ССЗ, а также обучаются собственные модели машинного обучения и строится обучающая нейронная сеть.

## Цель
```
На основе анализа предложенной научной статьи (https://www.sciencedirect.com/science/article/pii/S2772442522000016) и анализа данных пациентов с ССЗ ((https://www.kaggle.com/competitions/tech-weekend-data-science-hackathon/data)) необходимо обучить модели (Logistic Regression,   Randomforest, Neural Network) и сравнить результаты по предсказанию ССЗ.
```

## Краткое описание проекта

Данный учебный проект включает анализ данных пациентов и решение задачи бинарной классификации для предсказания наличия или отсутсвия ССЗ.

Проект состоит из следующих основных этапов:
```
    1. Анализ статьи о применении моделей машинного обучения для предсказания ССЗ (см. отдельный .md файл)
    2. Импорт библиотек и загрузка данных из датасетов.
    3. Первичное знакомство с данными.
    4. Обработка и очистка данных.
    5. Разведывательный анализ (Exploratory Data Analysis (EDA)).
    6. Отбор признаков, оценка признаков на мультиколлинеарность.
    7. Разделение выборки на тренировочную и тестовую.
    8. Подбор гиперпараметров моделей.
    9. Обучение и оценка трех моделей: Логистическая регрессия (Logistic Regression), Дерево решений (Decision Tree) и нейронная сеть (Neural Network).
```

## Импорт библиотек и загрузка данных из датасетов

В данном проекте использованы различные библиотеки Python для анализа данных, для визуализации, машинного обучения и построения нейросетей. Основные библиотеки: 
```
    - Pandas
    - NumPy
    - Seaborn
    - Scikit-learn
    - Matplotlib
    - Statsmodels
    -
```
Данные для исследования содержатся в двух CSV файлах: обучающая выборка - 'train.csv', и тестовая выборка- 'test.csv'.
Ссылка на статью (https://www.sciencedirect.com/science/article/pii/S2772442522000016). 

## Признаки и параметры из CSV файлов

Выбранный датасет содержит 600 000 записей в обучающем наборе и 400 000 в тестовом. Каждая запись содержит id пациента и 13 признаков, а также целевую переменную.

Признаки:

```
- 'age': (возраст пацента);
- 'sex': (пол пациента);
- 'chest': боль в груди (значения от 1 до 4); 
- 'resting_blood_pressure': (артериальное давление в состоянии покоя);
- 'serum_cholestoral': (уровень сывороточного холестерина в крови (mg/dl));
- 'fasting_blood_sugar': (анализ глюкозы в крови натощак (> 120 mg/dl));
- 'resting_electrocardiographic_results': (результаты электрокардиографических исследований в покое 0, 1, 2);
- 'maximum_heart_rate_achieved':(максимальная частота сердечных сокращений);
- 'exercise_induced_angina': (стенокардия при нагрузке),
- 'oldpeak' (депрессия ST-сегмента при нагрузке по сравнению с покоем);
- 'slope': (наклон пикового сегмента ST при физической нагрузке);
- 'number_of_major_vessels':  (количество крупных сосудов (0-3), окрашенных с помощью флюороскопии);
- 'thal': (3 = норма; 6 = фиксированный дефект; 7 = обратимый дефект);

```

Целевая переменная:
```
- 'class': (0 отсутствие ССЗ, 1 - наличие ССЗ ).

```

## Последовательность выполнения проекта
```
    0. Анализ статьи о применении моделей машинного обучения для предсказания ССЗ 
    1. Импорт библиотек и загрузка данных.
    2. Первичное знакомство с данными.
    3. Обработка и очистка данных, работа с пропущенными значениями, дубликатами и выбросами.
    4. Разведывательный анализ (Exploratory data analysis (EDA)).
    5. Исследование корреляции признаков и отбор подходящих для модели признаков.
    6. Разделение выборки на тренировочную и тестовую.
    7. Подбор гиперпараметров для моделей машинного обучения:
        --Logistic Regression;
        --Randomforest;
        --Neural Network. 
    7. Обучение и оценка моделей c использованием confusion matrices и classification reports для оценки работы моделей.
    8. Выводы
```

##  

Этот проект направлен на выявление нализия признаков сердечно-сосудистых заболеваний путем анализа различных параметров здоровья. Он включает предварительную обработку данных для очистки и подготовки данных к анализу. Предварительный анализ данных (EDA) дает ценную информацию о наборе данных, позволяя нам принимать обоснованные решения относительно выбора характеристик и обучения модели.

Процесс выбора окончательного выбора признаков включает в себя рассмотрение детальное изучение данных и выявление закономерностей, исследование  мультиколлинеальности для обеспечения точности модели. Настройка гиперпараметров выполняется для оптимизации производительности моделей машинного обучения.
```
В этом проекте используются три модели :
1. ** Логистическая регрессия**: Широко используемый алгоритм классификации, который оценивает вероятность бинарного исхода. Логистическая регрессия используется для прогнозирования вероятности сердечно-сосудистых заболеваний. Модель обучается с использованием гиперпараметров, оптимизированных с помощью поиска по сетке (GridSearch).
2. **Случайный лес **: ансамблевая модель с древовидной структурой, которая принимает решения на основе входных данных.  Гиперпараметры модели точно настроены для обеспечения оптимальной производительности.
3. ** MLPClassifier**: Мощный алгоритм нейросети для задач классификации из библиотеки sklearn. Он используется для прогнозирования сердечно-сосудистых заболеваний. Гиперпараметры модели оптимизируются с помощью поиска по сетке GridSearch.
4. ** Модель полносвязной нейросети**: нейросеть, созданная с помощью tensorflow.keras является мощным инструментом для решения разнообразных задач, в том числе задач классификации. Гиперпараметры - количество скрытых слоев, функции активации, функция потерь.
```
Модели оцениваются с использованием confusion_matrix и вывода подробного отчета с метриками, такими как accuracy/precision/recall (основная метрика, используемая в данной работе - accuracy), что позволяет получить представление об их эффективности в прогнозировании сердечно-сосудистых заболеваний.


## Замечания:

В описании к датасетам для анализа данных не было предоставлено подробного описания каждого из признаков, что могло повлиять на оценку выбросов в данных, а также на конечный выбор признаков для дальнейшего использования. 

Кроме того, некоторые числовые признаки были предоставлены с размерностью (точностью до 6 знаков после запятой, что не совсем объяснимо с точки зрения известных методик измерения).

Данный проект носит учебный характер, поэтому указанными выше замечаниями, было решено пренебречь.

##  Выводы

Для решения данной задачи подходят как модель машинного обучения случайный лес со следующими параметрами:
    [{'model': 'RandomForest',
       'best_score': 0.8637368924155558,
       'best_params': {'max_depth': 8, 'min_samples_leaf': 4, 'n_estimators': 400}}]

Так и модели нейросетей: MLPClassifier() со следующими параметрами:
    {'model': 'MLPClassifier',
    'best_score': 0.8632467049330188,
    'best_params': {'hidden_layer_sizes': 8,
    'learning_rate': 'constant',
    'max_iter': 100}}

А также полносвязная нейросеть:
    model_1 = Sequential()
    model_1.add(Dense( 64, activation = 'relu', input_shape = (7,)))
    model_1.add(Dense( 512, activation = 'relu'))
    model_1.add(Dense( 128, activation = 'relu'))
    model_1.add(Dense( 64, activation = 'relu'))
    model_1.add(Dense( 1, activation = 'sigmoid'))

    model_1.compile(
        loss = 'binary_crossentropy',
        optimizer = 'adam',
        metrics = ['accuracy'])
    



Во всех случаях качество метрики    accuracy на обеих выборках было сравнимо и равно 0.86.



